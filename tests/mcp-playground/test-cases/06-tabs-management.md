# 标签页管理测试

测试 Browsion MCP 的多标签页管理功能。

## 前置条件

- Browsion Tauri 应用正在运行
- Claude Code 已连接到 MCP 服务器
- test-profile 已启动浏览器

## 测试用例

### 1. 列出所有标签页

**在 Claude Code 中执行：**

```
请列出当前浏览器实例的所有标签页。
```

**预期结果：**
- 返回标签页列表
- 包含每个标签的 ID、URL、标题

**验证点：**
- ✅ 至少有一个标签页
- ✅ 显示正确的标签信息

---

### 2. 打开新标签页

**在 Claude Code 中执行：**

```
请打开一个新的标签页，并导航到 https://www.github.com。
```

**预期结果：**
- 新标签页创建成功
- 导航到 GitHub

**验证点：**
- ✅ 标签页数量增加
- ✅ 新标签显示正确 URL

---

### 3. 切换标签页

**在 Claude Code 中执行：**

```
请切换到第二个标签页（通过标签 ID）。
```

**预期结果：**
- 焦点切换到指定标签
- CDP 连接切换到新标签

**验证点：**
- ✅ 标签切换成功
- ✅ 后续操作在正确标签上执行

---

### 4. 等待新标签页

**在 Claude Code 中执行：**

```
请点击一个 target="_blank" 的链接（如果页面有的话），
然后等待新标签页打开。
```

**或者先导航到带链接的页面：**

```
请导航到 https://example.com，
然后点击页面上的第一个链接（如果有），
等待新标签页打开并捕获它。
```

**预期结果：**
- 检测到新标签页创建
- 返回新标签 ID

**验证点：**
- ✅ 成功捕获新标签
- ✅ 标签 ID 有效

---

### 5. 关闭标签页

**在 Claude Code 中执行：**

```
请关闭当前的标签页。
```

**预期结果：**
- 标签页关闭
- 返回成功确认

**验证点：**
- ✅ 标签数量减少
- ✅ 正确的标签被关闭

---

## 测试总结

本场景测试标签页管理功能：
- ✅ list_tabs - 列出所有标签页
- ✅ new_tab - 打开新标签页
- ✅ switch_tab - 切换标签页
- ✅ wait_for_new_tab - 等待新标签页打开
- ✅ close_tab - 关闭标签页

**多标签注意事项：**
- 切换标签后，所有后续操作（点击、输入等）都在当前活动标签上执行
- 使用 `list_tabs` 验证操作在正确的标签上执行
