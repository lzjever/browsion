# 浏览器生命周期测试

测试 Browsion MCP 的浏览器启动、停止和状态查询功能。

## 前置条件

- Browsion Tauri 应用正在运行
- Claude Code 已连接到 MCP 服务器
- test-profile 已导入

## 测试用例

### 1. 启动浏览器

**在 Claude Code 中执行：**

```
请为 mcp-test-profile 启动一个浏览器实例。
```

**预期结果：**
- 浏览器启动成功
- 返回进程 PID 和 CDP 端口
- 由于配置了代理，所有流量通过 `192.168.0.220:8889`

**验证点：**
- ✅ 返回非零 PID
- ✅ 返回有效的 CDP 端口
- ✅ 浏览器实际启动

**手动验证：**
- 打开 Chrome，检查是否能看到代理设置生效
- 访问 `https://httpbin.org/ip` 验证代理是否工作

---

### 2. 查询运行中的浏览器

**在 Claude Code 中执行：**

```
请列出当前所有运行中的浏览器实例。
```

**预期结果：**
- 返回运行中浏览器的列表
- 包含 PID、CDP 端口、启动时间等信息

**验证点：**
- ✅ 列表包含刚启动的 `mcp-test-profile`
- ✅ PID 与启动时返回的一致

---

### 3. 获取浏览器状态

**在 Claude Code 中执行：**

```
请检查 mcp-test-profile 的浏览器是否正在运行。
```

**预期结果：**
- 返回运行状态
- 如果正在运行，显示进程信息

**验证点：**
- ✅ 状态正确反映实际状态

---

### 4. 停止浏览器

**在 Claude Code 中执行：**

```
请停止 mcp-test-profile 的浏览器实例。
```

**预期结果：**
- 浏览器进程被终止
- 返回成功确认

**验证点：**
- ✅ 进程不再存在
- ✅ 再次查询运行状态显示未运行

---

## 测试总结

本场景测试浏览器生命周期的核心功能：
- ✅ launch_browser - 启动浏览器
- ✅ get_running_browsers - 列出运行中的浏览器
- ✅ 浏览器状态查询
- ✅ kill_browser - 停止浏览器

**代理验证：**
在浏览器运行期间，所有网络请求应该通过 `192.168.0.220:8889` 代理服务器。你可以通过访问 IP 查询网站来验证。
