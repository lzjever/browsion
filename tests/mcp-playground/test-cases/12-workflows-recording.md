# 工作流和录制测试

测试 Browsion MCP 的工作流自动化和录制功能。

## 前置条件

- Browsion Tauri 应用正在运行
- Claude Code 已连接到 MCP 服务器
- test-profile 已导入并启动浏览器

## 测试用例

### 1. 列出工作流

**在 Claude Code 中执行：**

```
请列出所有可用的工作流（Workflows）。
```

**预期结果：**
- 返回工作流列表
- 显示工作流 ID、名称、步骤数等

**验证点：**
- ✅ 返回列表（可能为空）
- ✅ 格式正确

---

### 2. 创建工作流

**在 Claude Code 中执行：**

```
请创建一个新的工作流：
- 名称: 测试导航工作流
- 描述: 自动化导航测试
- 步骤:
  1. 导航到 https://example.com
  2. 获取页面标题
```

**预期结果：**
- 工作流创建成功
- 返回工作流详情

**验证点：**
- ✅ 工作流保存成功
- ✅ 可以在工作流列表中看到

---

### 3. 运行工作流

**在 Claude Code 中执行：**

```
请为 mcp-test-profile 运行工作流（如果有的话），
或者创建一个简单的工作流并运行它。
```

**预期结果：**
- 工作流执行
- 返回执行结果

**验证点：**
- ✅ 工作流步骤按顺序执行
- ✅ 返回执行状态和结果

---

### 4. 开始录制

**在 Claude Code 中执行：**

```
请为 mcp-test-profile 开始录制（Recording）。
```

**预期结果：**
- 录制会话启动
- 返回会话 ID

**验证点：**
- ✅ 录制状态激活
- ✅ 返回有效的 session_id

---

### 5. 检查录制状态

**在 Claude Code 中执行：**

```
请检查 mcp-test-profile 的录制状态。
```

**预期结果：**
- 返回录制状态信息
- 包含是否正在录制、动作数量等

**验证点：**
- ✅ 状态信息正确
- ✅ 动作计数准确

---

### 6. 停止录制

**在 Claude Code 中执行：**

```
请停止当前的录制会话。
```

**预期结果：**
- 录制会话停止
- 保存录制数据

**验证点：**
- ✅ 录制数据保存
- ✅ 会话结束

---

### 7. 录制转换为工作流

**在 Claude Code 中执行：**

```
请将一个录制转换为工作流：
- 录制 ID: [从停止录制获取]
- 工作流名称: 从录制生成的工作流
```

**预期结果：**
- 录制数据转换为工作流
- 工作流可以重新执行

**验证点：**
- ✅ 工作流创建成功
- ✅ 包含录制中的所有动作

---

## 测试总结

本场景测试工作流和录制功能：
- ✅ list_workflows - 列出工作流
- ✅ get_workflow - 获取工作流详情
- ✅ create_workflow - 创建工作流
- ✅ update_workflow - 更新工作流
- ✅ delete_workflow - 删除工作流
- ✅ run_workflow - 运行工作流
- ✅ start_recording - 开始录制
- ✅ stop_recording - 停止录制
- ✅ get_recording_status - 获取录制状态
- ✅ recording_to_workflow - 录制转工作流

**工作流执行模式：**
- 同步执行 - 逐步执行，每步等待完成
- continue_on_error - 遇到错误是否继续
- timeout_ms - 每步超时时间

**录制用途：**
- 记录手动操作流程
- 自动生成工作流
- 回放和文档化测试步骤

**工作流变量：**
- 支持变量替换
- 动态参数化
- 环境变量注入
